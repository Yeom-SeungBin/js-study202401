<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>

  <script>
    const traders = [{
        trader: {
          name: "김철수",
          city: "대전",
        },
        year: 2023,
        value: 500000,
      },
      {
        trader: {
          name: "박영희",
          city: "서울",
        },
        year: 2022,
        value: 600000,
      },
      {
        trader: {
          name: "김철수",
          city: "대전",
        },
        year: 2022,
        value: 1200000,
      },
      {
        trader: {
          name: "박영희",
          city: "서울",
        },
        year: 2023,
        value: 650000,
      },
      {
        trader: {
          name: "뽀로로",
          city: "부산",
        },
        year: 2023,
        value: 800000,
      },
      {
        trader: {
          name: "루피",
          city: "대전",
        },
        year: 2022,
        value: 780000,
      },
    ];

    // 연습 1: 2022년에 발생한 모든 거래를 찾아
    // 거래자 정보(이름, 도시)를 배열에 매핑해주세요

    // traders.filter(t => t.year === 2022)
    //   .map(t => {
    //     return {
    //       name: t.trader.name,
    //       city: t.trader.city
    //     }
    //   })
    //   .forEach(t => console.log(`(2022년에 발생한 거래의 정보) 이름 : ${t.name}, 도시 : ${t.city}`));
    
    traders
      .filter(trs => trs.year === 2022)
      .map(trs => trs.trader) // 이름과 도시가 trader로 묶여 있으므로 
      .forEach(trs => console.log(trs));

    console.log('=======================================================================');

    // 연습 2: 거래자가 근무하는 모든 도시이름을 배열에 담아주세요.

    // const traderCity = traders.map(t => t.trader.city);
    // console.log(traderCity);

    const mappedCities = traders.map(trs => trs.trader.city);
    console.log(mappedCities);
    // mappedCities.forEach(city => console.log(city));

    console.log('=======================================================================');

    // 연습 3: 대전에 근무하는
    // 모든 거래자를 찾아 거래자정보(이름, 도시)를 배열에 매핑해주세요.

    // traders.filter(t => t.trader.city === '대전')
    //   .map(t => `(대전에 근무하는 거래자 정보) 이름 : ${t.trader.name}, 도시 : ${t.trader.city}`).forEach(a => console.log(a));

    traders
      .filter(trs => trs.trader.city === '대전')
      .map(trs => trs.trader)
      .forEach(trd => console.log(trd));

    console.log('=======================================================================');

    // 연습 4: 모든 거래자의 이름을 배열에 모아주세요.

    // traders.map(n => n.trader.name)
    //   .forEach(name => console.log('모든 거래자의 이름 : ' + name));

    const mappedNames = traders.map(trs => trs.trader.name);
    // console.log(mappedNames);
    const names = new Set(mappedNames); // 중복 제거
    console.log(names);

    console.log('=======================================================================');

    // 연습 5: 서울에 사는 거래자의 모든 거래액의 총합 출력.

    // 오류남
    // let total = 0;
    // const totalValue = traders.filter(s => s.trader.city === '서울')
    //   .map(a => a.value);

    // total += totalValue;
    // console.log('서울에 사는 거래자의 모든 거래액의 총합 = ' + total);

    /*
    let total = 0;

    traders
      .filter(trs => trs.trader.city === '서울')
      // .forEach(trs => total += trs.value);
      .map(trs => trs.value)
      .forEach(val => total += val);

    console.log('거래 총액 : ' + total + '원');
    */

    // reduce 함수 : 배열을 반복해서 각 요소에 콜백함수를 적용한 결과를 누적하는 함수
    /* 
      array.reduce((누적값, 배열 요소) => 반복해서 실행할 내용(누적연산), 초기값);
    */
    const total = traders
      .filter(trs => trs.trader.city === '서울')
      .reduce((acc, curr) => acc+ curr.value, 0)
    
    console.log(`거래 총액 : ${total}원`);
      
  </script>

</body>

</html>